# 総評

今回はPwn問題は
1. netcat
2. free-hook
3. rop-machine-easy
4. rop-machiine-normal
5. rop-machine-hard
6. srop
7. tower-of-hanoi
8. gacha-breaker

の計8問。
今回からEBeb君が参加してくれて2人で参加しました。
EBeb君は既に僕(saru)よりPwnに詳しくなっていて今後にかなり期待できる新人！ //まだまだ経験不足なのでこれからもよろしくお願いします。-EBeb-  
と言うわけでhard以上の問題はEBeb君に任せて僕はbeginner～normalの初心者が楽しめるところに注力して作問しました。

Pwnはコンピューターの内部のCPUに触れている感じが僕としてはとても好きで、もっと多くの人に楽しんでもらいたいなー、と思っているジャンルです。
そして結構ハードルが高くて敬遠してしまう人が多いジャンルでもあります。
なのでPwnerが少しでも増えれば！と考えて少しずつ階段を上りながらPwnについて学べる問題を作ろうとしました。

が、正直階段をうまく作るのを失敗しました．．．
解けた数順に並べると以下の通り。(2021/05/01 13:24)

- 199 (100%): netcat 
- 63  (31%): rop-machine-easy
- 53  (84%): rop-machiine-normal
- 47  (88%): free-hook 
- 42  (89%): rop-machine-hard
- 24  (57%): srop
- 14  (58%): tower-of-hanoi
- 8   (57%): gacha-breaker

明らかにrop-machine-easyで減りすぎ．．．せめてnetcatの80%、最悪でも50%の人が解けるような問題を用意したかったです。

前回のWaniCTF 2020でpwnはropのところに大きな壁があったのでここをうまく埋めるような問題を作りたいな、と思って作問しましたが、うまく行かなかったです。
ROP (return oriented programming)はPwnを始めて感動したテクニックの1つです。
ret命令でスタックを掘りながら自由自在にプログラムを組むことができます。
その感動を少しでも共有したかったのですが、なかなか難しかったです。

netcatの次は去年出した問題の改良程度にすればよかったとか、rop-machine-easyの前にsystem("/bin/sh")の雰囲気が分かる問題が作れただろうか、とか開催中もいろいろあーでもない、こーでもない、と悩んでました。

とはいえ国内の有名CTF playerがすごい勢いで解いてくれているのを見て、7. tower-of-hanoi、8. gacha-breakerとか僕は結構時間がかかるのでトッププレイヤーはどのくらいの速度で解くんだろうと思ったら瞬殺されたりしているのを見て、運営としては感動もある楽しい3日間でした。
Pwn問題を解いてくださった皆さま、ありがとうございました。

```
文責: saru
```

ここからはEBebが書かせて頂きます。  
pwn 6 srop  
pwn 7 tower-of-hanoi  
pwn 8 gacha-breaker   
を作問させて頂きました。  
初者でありながら初作問させて頂きました。  
作問しながらテーマ作りからコードの作成、難易度の調節とデプロイまで大変なことも多く、WaniCTFチームの皆さんに色々助けてもらいました。  
初心者の作問で色々不足なところが多く、実際に始めてから発見された不足な部分もいくつかありました。  
初心者の初作問を楽しんで頂いた皆様、誠にありがとうございます。  

pwn06はrop-machineから続いて、もうちょっとリアルな状況でちょっと特集なropの練習のために作りました。  
レジスターの値を一気に書き換えできるのが面白い方法だなと思いました。    
強力なGadgetを直接与えた分、他の解き方もあるとは思われます。  
pwnといえばpwntoolsだと思ってpwntoolsを使う必要がある形にして、pwntoolsの簡単な説明を未熟ながら書いてみました。  

pwn07はプログラミングを勉強している実家の兄の課題をチェックしてる途中、負の数の検査が抜けたことを見て「ここ検査が足りないよ」と言ったら「ここに負の数を入れる人っている？」と言ったのを聞いてから「は？」と思って作りました。  
全ての人間が常識的な値を入れるのではないということを伝えたい問題でした。実はこの問題はnormal、hard狙いで作った問題ですが、話し合いした結果veryhardになりました。  
veryhardで書かれていますが、よく見れば解き方は簡単な問題です。Canaryがあってもよい問題ですが、Stack protectorがあったら変数の配置の変更よりもっと簡単な問題になってしまうのでstack-protectorのみ解除しておきました。順番が[solved flag][pivot array]となって -1に何かを動かすだけでsolved flagが１になります…

pwn08は実は僕もheapの勉強を兼ねて作りました。作りながら概念が曖昧な部分は色々試しながら作ったらコードが汚い部分がありました。😢  
もしコードの書き方が紛らわしい部分か、ミスで損したかたがいらっしゃったら申し訳ございません。  
heapと言っても様々な種類の弱点があって、その中で典型的なtcache poisoningをテーマにしました。free-hook問題の延長といったら延長となります。  
free-hookの内容を変えるとどうなるかを分かっていただいたら、そこをどう書き換えるかについての問題でした。  
テーマを悩んでた途中、韓国でゲームの確率操作が大きな話題になっていたので、そこからアイディアを貰いました。  
僕にとっても挑戦的な作問だったんですが、多くの方が解いてくださるのを感動しながら見てました。ありがとうございます。  
今回の経験に基づいて、次回は僕以外の初心者もheapの基本的な概念を掴めるのを助けられる問題が作りたいです。  

初心者の初作問を楽しんで頂いて改めてありがとうございます。  
次回はもっと色んな方がもっと楽しめる問題を作れるように精進します。  
よろしくお願いいたします。
```
文責: EBeb
```
