# 問題名
OUCS
## 問題文
OUによるHomomorphicなCryptoSystemです

```
nc oucs.cry.wanictf.org 50010
```

## フラグ
`FLAG{OU_d0es_n0t_repre53nt_Osaka_University_but_Okamoto-Uchiyama}`

## 解法
接続先のサービスでできることは以下の通りです。
- 暗号化された flag を取得
- 任意の平文を暗号化
- 任意の暗号文を復号(ただし復号結果が flag と一致した場合は、結果を非表示）
- 公開鍵を取得

暗号化された flag を復号できれば当然 flag は手に入りますが、このサービスではそれを検出して表示してくれません。何とかして回避できないでしょうか？

このサービスで利用している暗号が準同形暗号であることを利用できそうです。
元の暗号文と別の暗号文を作り、これを復号させた結果を元にして flag を入手することができます。


```
      ┌──────────────────┐                    ┌────────┐
      │                  │         \ /        │        │
      │  Encrypt(flag)   ├─────────►X         │  flag  │
      │                  │         / \        │        │
      └─────────┬────────┘                    └────▲───┘
                │                                  │
                │                                  │
                │                                  │
                │                                  │
┌───────────────▼──────────────┐            ┌──────┴─────┐
│                              │            │            │
│  Encrypt(flag) * Encrypt(x)  ├────────────►  flag + x  │
│                              │            │            │
└──────────────────────────────┘            └────────────┘

```


[解法スクリプト](solver/solve.py)

